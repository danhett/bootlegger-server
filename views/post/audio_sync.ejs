<style>
	    .btn-file {
	    position: relative;
	    overflow: hidden;
	    }
	    .btn-file input[type=file] {
	    position: absolute;
	    top: 0;
	    right: 0;
	    min-width: 100%;
	    min-height: 100%;
	    font-size: 999px;
	    text-align: right;
	    filter: alpha(opacity=0);
	    opacity: 0;
	    outline: none;
	    background: white;
	    cursor: inherit;
	    display: block;
	    }
</style>
<div class="row">
	<div class="col-sm-2">
		<label>Audio Sync <br><a class="small" href="/post/module_function/audio_sync?func=reset&event=<%-event %>">Reset</a></label>
	</div>
	<div id="progress" class="col-sm-6" style="display:none">
		<div class="progress">
		  <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
		    <span class="sr-only">60% Complete</span>
		  </div>
		</div>
	</div>



	<div class="col-sm-6" id="inpgrp"> 
		<form action="/post/module_function/audio_sync" enctype="multipart/form-data" method="POST" > 
			
		<input type="hidden" name="event" value="<%- event %>"/> 
		<input type="hidden" name="func" value="upload"/>
		<div class="input-group" >
		        <span class="input-group-btn">
		            <span class="btn btn-primary btn-file">
		                Browse&hellip; <input type="file" name="file">
		            </span>
		        </span>
		        <input type="text" class="form-control" readonly>
		</div>
		<br>
		<input type="submit" value="Upload" class="col-sm-2 btn btn-primary" />



		</form>
	</div>

	<div class="col-sm-4" id="desc">
		<div class="popover" style="display:inline-block;right:25px;left:inherit;position:relative;float:right;">
		    <div class="arrow"></div>
		    <h3 class="popover-title"><%- name %></h3>
		    <div class="popover-content">
		      <p><%- description %></p>
		    </div>
		</div>
	</div>

</div>
<div class="row" id="approx">

	<div class="col-sm-12">
		<div class="panel small">Without providing a master audio track of the event, we can generate an EDL with approximate timings <a href="/post/module_function/audio_sync?func=getedl&event=<%-event %>">Download Approximated EDL</a>
		</div>
	</div>
</div>
<div class="row" id="download" style="display:none;">
	<div class="col-sm-12">
		We have added your synced EDL to the files for your dropbox, otherwise you can download it <a href="/post/module_function/audio_sync?func=getedl&event=<%-event %>">Here</a>
	</div>
</div>



<script>
	//get progress
	$(function()
	{
		$.get('/post/module_function/audio_sync',{event:'<%- event %>',func:'progress'},function(data)
		{
			console.log(data);
			if (data.progress != -1)//not started process...
			{
				//FOR DEBUG:
				$('#inpgrp').hide();
				$('#progress').show();
				$('#desc').hide();

				if (data.progress != 100)
				{					
					//console.log('setting interval');
					//trigger update
					setInterval(function(){
						$.get('/post/module_function/audio_sync',{event:'<%- event %>',func:'progress'},function(data)
						{
							//console.log(data.progress);
							$('.progress-bar').css('width', data.progress+'%').attr('aria-valuenow', data.progress);
							if (data.progress == 100)
							{
								$('#approx').hide();
								$('#download').show();
								$('#progress').hide();
								$('#desc').hide();
							}
							//$('#progress > progress > progress-bar').css('width',data.progress+"%");
						});
					}, 1000);
				}
				else
				{
					//done
					$('#approx').hide();
					$('#download').show();
					$('#desc').hide();
					$('#progress').hide();
				}
			}
		});
	});
</script>